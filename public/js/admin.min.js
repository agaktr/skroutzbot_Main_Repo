function startBrain(){$.ajax({type:"POST",url:siteUrl+"brain/run",data:{},success:function(e){200===e.status?setTimeout((function(){startBrain()}),1e3):201===e.status&&setTimeout((function(){startBrain()}),2e4),$("#resp").empty().append(JSON.stringify(e)),console.log(e)},error:function(e,t,a){console.log("Status: "+t),console.log("Error: "+a)}})}$(document).ready((function(){if($("#daUserProfileTable").length&&$("#daUserProfileTable").DataTable(),$("#showProductListTable").length){var e=$(location).attr("href").split("/"),t="http://192.168.1.100/skroutzbot/public/user-profile/get-products?profile="+e[e.length-1],a=[];$.ajax({type:"POST",url:t,dataType:"json",success:function(e){$.each(e,(function(e,t){a.push({sku:t.sku,competitors:t.competitors,ean:t.ean,matched:t.matched,mpn:t.mpn,name:t.name,photo:t.photo,price:t.price,update:t.update})}));$("#showProductListTable").DataTable({paging:!0,ordering:!0,info:!1,data:a,columns:[{data:"sku"},{data:"photo"},{data:"name"},{data:"mpn"},{data:"ean"},{data:"matched"},{data:"competitors"},{data:"price"},{data:"update"}]})},error:function(e,t,a){console.log("Status: "+t),console.log("Error: "+a)}})}})),$(".startMatch").on("click",(function(e){e.preventDefault();var t=$(this).parent().parent().parent().parent().parent().find(".matchListProductName").html();if(window.confirm("Are you sure you want to match this item with \n"+t+" ?")){var a=$(this).closest("[data-sku]").data("sku"),o=$(".matchForm").serialize();$.ajax({type:"POST",url:siteUrl+"user-profile/match",data:{match:o},success:function(e){200===e.status&&$("[data-sku="+a+"]").remove(),console.log(e)},error:function(e,t,a){console.log("Status: "+t),console.log("Error: "+a)}})}})),$("#matchSubmit").on("click",(function(e){e.preventDefault();var t=$("#matchForm").serialize(),a=$("#matchForm #sku").val();console.log(t),$.ajax({type:"POST",url:siteUrl+"user-profile/match",data:{match:t},success:function(e){200===e.status&&$("[data-sku="+a+"]").remove(),console.log(e)},error:function(e,t,a){console.log("Status: "+t),console.log("Error: "+a)}})})),$("#downloadXML").on("click",(function(e){e.preventDefault();var t=$("#matchForm").serialize(),a=$(this).attr("data-profile");console.log(t),$.ajax({type:"GET",url:siteUrl+"user-profile/download",data:{profile:a},success:function(e){var t=document.createElement("a");t.setAttribute("download",e.filename.replace("uploads/generated/","")),t.href=siteUrl+e.filename,document.body.appendChild(t),t.click(),t.remove(),console.log(e)},error:function(e,t,a){console.log("Status: "+t),console.log("Error: "+a)}})})),$("#startBrain").on("click",(function(e){e.preventDefault(),startBrain()}));var productId,siteUrl="http://192.168.1.100/skroutzbot/public/";$("#step1Submit").on("click",(function(){var e=$("#daRequest").val(),t=$("input[name=stepOneRequest]:checked","#step1").val();if("nameRequest"==t)var a=siteUrl+"api/search?name="+e;else if("urlRequestRadio"==t)a=siteUrl+"api/search?url="+e;console.log(a),null!=a?$.ajax({url:a,success:function(e){if($("#productsTable tr").remove(),$("#productImage").attr("src",""),$("#lowestPrice").html(""),$("#productTable tr").remove(),console.log("result",e),e.active>0){var t=e.products;console.log(t),$.each(t,(function(e,t){$("#productsTable").append("<tr><td><input type='radio' name='productRadio' id='s-"+t.uuid+"' value='"+t.uuid+"'></td><td><label for='s-"+t.uuid+"'>"+t.Name+"</label></td><td><a href='"+t.Url+"' target='_blank'>URL</a></td></tr>")})),$("#step1").removeClass("active"),$("#step2").addClass("active")}else console.log("no results")}}):alert("Check url or name")})),$("#step2Submit").on("click",(function(){var e=$("input[name=productRadio]:checked","#step2").val(),t=siteUrl+"api/fetch?ids="+e;console.log(t),$("#productTable tr").remove(),$.ajax({url:t,success:function(e){console.log("result",e),productId=e.productData.uuid,$("#productImage").attr("src",e.productData.photo),$("#productName").html(e.productData.name),$("#lowestPrice").html("Χαμηλότερη τιμή αυτή την στιγμή: "+e.prices[0].price.NetPrice+"€"),$.each(e.prices,(function(e,t){$("#productTable").append("<tr style='color: rgb(55, 54, 54);'><td><input type='checkbox' name='productList' id='p-"+t.shop.uuid+"' value='"+t.shop.uuid+"' disabled></td><td><label for='p-"+t.shop.uuid+"'>"+t.shop.name+"</label></td><td>"+t.price.NetPrice+"€</td></tr>")}));e.productData.uuid;$("#step2").removeClass("active"),$("#step3").addClass("active")}})})),$(".step3Submit").on("click",(function(){$("#step3").removeClass("active"),$("#step4").addClass("active")})),$("#step4Submit").on("click",(function(){var e=new Array,t=$("input[name=shopsRadio]:checked","#step3").val(),a=$("#posostieaPrice").val(),o=$("#elaxistiPrice").val();null!=t?("shopSelected"==t&&$.each($("input[name='productList']:checked"),(function(){e.push($(this).val())})),$.ajax({url:siteUrl+"api/save",type:"POST",data:{mode:t,competitors:e,increment:a,lowestPrice:o,productId:productId}}).done((function(){console.log("Sended")}))):alert("Check Χαμηλότερη or Χαμηλότερη από ανταγωνιστές")})),$("form#uploadForm").submit((function(e){e.preventDefault();var t=new FormData(this);$.ajax({url:siteUrl+"user-profile/save",type:"POST",data:t,success:function(e){window.location.href=siteUrl+"user-profile"},cache:!1,contentType:!1,processData:!1})})),$("#step2Back").on("click",(function(){$("#step2").removeClass("active"),$("#step1").addClass("active")})),$(".step3Back").on("click",(function(){$("#step3").removeClass("active"),$("#step2").addClass("active")})),$("#step4Back").on("click",(function(){$("#step4").removeClass("active"),$("#step3").addClass("active")})),$('input:radio[name="stepOneRequest"]').on("change",(function(){$(this).parent().css("border","1px solid #F68B24"),"nameRequest"==$(this).val()?$("#urlRequestRadio").parent().css("border","0"):"urlRequestRadio"==$(this).val()&&$("#nameRequestRadio").parent().css("border","0")})),$('input:radio[name="shopsRadio"]').on("change",(function(){$(this).parent().css("border","1px solid #F68B24"),"shopFirst"==$(this).val()?($("#shopSelected").parent().css("border","0"),$('input:checkbox[name="productList"]').prop("disabled",!0),$('input:checkbox[name="productList"]').parent().parent().css("color","#373636")):"shopSelected"==$(this).val()&&($("#shopFirst").parent().css("border","0"),$('input:checkbox[name="productList"]').prop("disabled",!1),$('input:checkbox[name="productList"]').parent().parent().css("color","#fff"))})),$("#shopFirst").attr("checked",!0),$("#shopFirst").parent().css("border","1px solid #F68B24"),$("#nameRequestRadio").attr("checked",!0),$("#nameRequestRadio").parent().css("border","1px solid #F68B24"),$("#goCSV").on("click",(function(){$("#step1").removeClass("active"),$("#csvDiv").addClass("active")}));var shopsSelectedCsv=new Array;function uuidExists(e){if(shopsSelectedCsv.find(t=>t.shopUuid===e))return"checked "}function removeShop(e){$("#ss-"+e).remove(),shopsSelectedCsv=shopsSelectedCsv.filter((function(t){return t.shopUuid!==e}))}$("#searchCom").keyup((function(){var e=null,t=$(this).val();t.length>=3?(null!=e&&e.abort(),e=$.ajax({type:"GET",url:siteUrl+"api/shop/suggest",headers:{Authorization:"b443b7226ea805f12d25fa1a23d86c15aa434bea719d4364a35000a061a8bf18920a1cd5fd781d3bca47606d65aae05fc78d82be8f4eedfa01cd8ec5"},data:{s:t},dataType:"text",success:function(e){$("#comTable tr").remove();var t=(e=JSON.parse(e)).shops;$.each(t,(function(e,t){$("#comTable").append("<tr><td><input type='checkbox' name='shopCheckbox[]' id='com-"+t.uuid+"' value='"+t.uuid+"' "+uuidExists(t.uuid)+"></td><td><label data-img='"+t.Image+"' for='com-"+t.uuid+"'>"+t.Name+"</label></td></tr>")})),$('input:checkbox[name="shopCheckbox[]"]').on("change",(function(){var e=$(this).val(),t=$(this).parent().parent().find("label").html(),a=$(this).parent().parent().find("label").data("img");this.checked?(shopsSelectedCsv.push({shopUuid:e,shopName:t,shopImage:a}),$("#shopsCheckedList").append("<div class='shopChecked relative col m3 l3' id='ss-"+e+"'><div onclick=\"removeShop('"+e+"')\" class='removeShopArray absolute'>X</div><div class='shopCheckedTitle color-white'>"+t+"</div><div class='shopCheckedImage'><img src='"+a+"' alt=''></div></div>")):this.checked||removeShop(e)}))},error:function(e,t,a){console.log("Status: "+t),console.log("Error: "+a)}})):$("#comTable tr").remove()}));