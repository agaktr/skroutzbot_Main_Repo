function startBrain(){$.ajax({type:"POST",url:"http://192.168.1.100/skroutzbot/public/brain/run",data:{},success:function(t){200===t.status?setTimeout((function(){startBrain()}),1e3):201===t.status&&setTimeout((function(){startBrain()}),2e4),$("#resp").empty().append(JSON.stringify(t)),console.log(t)},error:function(t,e,a){console.log("Status: "+e),console.log("Error: "+a)}})}var productId;$(document).ready((function(){if($("#daUserProfileTable").length&&$("#daUserProfileTable").DataTable(),$("#showProductListTable").length){var t=$(location).attr("href").split("/"),e="http://192.168.1.100/skroutzbot/public/user-profile/get-products?profile="+t[t.length-1],a=[];$.ajax({type:"POST",url:e,dataType:"json",success:function(t){$.each(t,(function(t,e){a.push({sku:e.sku,competitors:e.competitors,ean:e.ean,matched:e.matched,mpn:e.mpn,name:e.name,photo:e.photo,price:e.price,update:e.update})}));$("#showProductListTable").DataTable({paging:!0,ordering:!0,info:!1,data:a,columns:[{data:"sku"},{data:"photo"},{data:"name"},{data:"mpn"},{data:"ean"},{data:"matched"},{data:"competitors"},{data:"price"},{data:"update"}]})},error:function(t,e,a){console.log("Status: "+e),console.log("Error: "+a)}})}})),$(document).click((function(t){$(t.target).closest(".modal,.startMatch").length||$("#matchModal").removeClass("active")})),$("#matchSubmit").on("click",(function(t){$("#matchModal").removeClass("active")})),$(".startMatch").on("click",(function(t){t.preventDefault(),$("#matchModal").addClass("active");var e=$(this).closest("[data-profile]").attr("data-profile"),a=$(this).closest("[data-sku]").attr("data-sku");$("#profile").val(e),$("#sku").val(a),$("#product").empty(),$.each($(this).closest("[data-sku]").find("[data-product]"),(function(){$("#product").append('<option value="'+$(this).attr("data-product")+'">'+$(this).attr("data-product-name")+"</option>")}))})),$("#matchSubmit").on("click",(function(t){t.preventDefault();var e=$("#matchForm").serialize(),a=$("#matchForm #sku").val();console.log(e),$.ajax({type:"POST",url:"http://192.168.1.100/skroutzbot/public/user-profile/match",data:{match:e},success:function(t){200===t.status&&$("[data-sku="+a+"]").remove(),console.log(t)},error:function(t,e,a){console.log("Status: "+e),console.log("Error: "+a)}})})),$("#downloadXML").on("click",(function(t){t.preventDefault();var e=$("#matchForm").serialize(),a=$(this).attr("data-profile");console.log(e),$.ajax({type:"GET",url:"http://192.168.1.100/skroutzbot/public/user-profile/download",data:{profile:a},success:function(t){var e=document.createElement("a");e.setAttribute("download",t.filename.replace("uploads/generated/","")),e.href="http://192.168.1.100/skroutzbot/public/"+t.filename,document.body.appendChild(e),e.click(),e.remove(),console.log(t)},error:function(t,e,a){console.log("Status: "+e),console.log("Error: "+a)}})})),$("#startBrain").on("click",(function(t){t.preventDefault(),startBrain()})),$("#step1Submit").on("click",(function(){var t=$("#daRequest").val(),e=$("input[name=stepOneRequest]:checked","#step1").val();if("nameRequest"==e)var a="http://192.168.1.100/skroutzbot/public/api/search?name="+t;else if("urlRequestRadio"==e)a="http://192.168.1.100/skroutzbot/public/api/search?url="+t;console.log(a),null!=a?$.ajax({url:a,success:function(t){if($("#productsTable tr").remove(),$("#productImage").attr("src",""),$("#lowestPrice").html(""),$("#productTable tr").remove(),console.log("result",t),t.active>0){var e=t.products;console.log(e),$.each(e,(function(t,e){$("#productsTable").append("<tr><td><input type='radio' name='productRadio' id='s-"+e.uuid+"' value='"+e.uuid+"'></td><td><label for='s-"+e.uuid+"'>"+e.Name+"</label></td><td><a href='"+e.Url+"' target='_blank'>URL</a></td></tr>")})),$("#step1").removeClass("active"),$("#step2").addClass("active")}else console.log("no results")}}):alert("Check url or name")})),$("#step2Submit").on("click",(function(){var t="http://192.168.1.100/skroutzbot/public/api/fetch?ids="+$("input[name=productRadio]:checked","#step2").val();console.log(t),$("#productTable tr").remove(),$.ajax({url:t,success:function(t){console.log("result",t),productId=t.productData.uuid,$("#productImage").attr("src",t.productData.photo),$("#productName").html(t.productData.name),$("#lowestPrice").html("Χαμηλότερη τιμή αυτή την στιγμή: "+t.prices[0].price.NetPrice+"€"),$.each(t.prices,(function(t,e){$("#productTable").append("<tr style='color: rgb(55, 54, 54);'><td><input type='checkbox' name='productList' id='p-"+e.shop.uuid+"' value='"+e.shop.uuid+"' disabled></td><td><label for='p-"+e.shop.uuid+"'>"+e.shop.name+"</label></td><td>"+e.price.NetPrice+"€</td></tr>")}));t.productData.uuid;$("#step2").removeClass("active"),$("#step3").addClass("active")}})})),$(".step3Submit").on("click",(function(){$("#step3").removeClass("active"),$("#step4").addClass("active")})),$("#step4Submit").on("click",(function(){var t=new Array,e=$("input[name=shopsRadio]:checked","#step3").val(),a=$("#posostieaPrice").val(),o=$("#elaxistiPrice").val();null!=e?("shopSelected"==e&&$.each($("input[name='productList']:checked"),(function(){t.push($(this).val())})),$.ajax({url:"http://192.168.1.100/skroutzbot/public/api/save",type:"POST",data:{mode:e,competitors:t,increment:a,lowestPrice:o,productId:productId}}).done((function(){console.log("Sended")}))):alert("Check Χαμηλότερη or Χαμηλότερη από ανταγωνιστές")})),$("form#uploadForm").submit((function(t){t.preventDefault();var e=new FormData(this);$.ajax({url:"http://192.168.1.100/skroutzbot/public/user-profile/save",type:"POST",data:e,success:function(t){window.location.href="http://192.168.1.100/skroutzbot/public/user-profile"},cache:!1,contentType:!1,processData:!1})})),$("#step2Back").on("click",(function(){$("#step2").removeClass("active"),$("#step1").addClass("active")})),$(".step3Back").on("click",(function(){$("#step3").removeClass("active"),$("#step2").addClass("active")})),$("#step4Back").on("click",(function(){$("#step4").removeClass("active"),$("#step3").addClass("active")})),$('input:radio[name="stepOneRequest"]').on("change",(function(){$(this).parent().css("border","1px solid #F68B24"),"nameRequest"==$(this).val()?$("#urlRequestRadio").parent().css("border","0"):"urlRequestRadio"==$(this).val()&&$("#nameRequestRadio").parent().css("border","0")})),$('input:radio[name="shopsRadio"]').on("change",(function(){$(this).parent().css("border","1px solid #F68B24"),"shopFirst"==$(this).val()?($("#shopSelected").parent().css("border","0"),$('input:checkbox[name="productList"]').prop("disabled",!0),$('input:checkbox[name="productList"]').parent().parent().css("color","#373636")):"shopSelected"==$(this).val()&&($("#shopFirst").parent().css("border","0"),$('input:checkbox[name="productList"]').prop("disabled",!1),$('input:checkbox[name="productList"]').parent().parent().css("color","#fff"))})),$("#shopFirst").attr("checked",!0),$("#shopFirst").parent().css("border","1px solid #F68B24"),$("#nameRequestRadio").attr("checked",!0),$("#nameRequestRadio").parent().css("border","1px solid #F68B24"),$("#goCSV").on("click",(function(){$("#step1").removeClass("active"),$("#csvDiv").addClass("active")}));var shopsSelectedCsv=new Array;function uuidExists(t){if(shopsSelectedCsv.find(e=>e.shopUuid===t))return"checked "}function removeShop(t){$("#ss-"+t).remove(),shopsSelectedCsv=shopsSelectedCsv.filter((function(e){return e.shopUuid!==t}))}$("#searchCom").keyup((function(){var t=null,e=$(this).val();e.length>=3?(null!=t&&t.abort(),t=$.ajax({type:"GET",url:"http://192.168.1.100/skroutzbot/public/api/shop/suggest",headers:{Authorization:"b443b7226ea805f12d25fa1a23d86c15aa434bea719d4364a35000a061a8bf18920a1cd5fd781d3bca47606d65aae05fc78d82be8f4eedfa01cd8ec5"},data:{s:e},dataType:"text",success:function(t){$("#comTable tr").remove();var e=(t=JSON.parse(t)).shops;$.each(e,(function(t,e){$("#comTable").append("<tr><td><input type='checkbox' name='shopCheckbox[]' id='com-"+e.uuid+"' value='"+e.uuid+"' "+uuidExists(e.uuid)+"></td><td><label data-img='"+e.Image+"' for='com-"+e.uuid+"'>"+e.Name+"</label></td></tr>")})),$('input:checkbox[name="shopCheckbox[]"]').on("change",(function(){var t=$(this).val(),e=$(this).parent().parent().find("label").html(),a=$(this).parent().parent().find("label").data("img");this.checked?(shopsSelectedCsv.push({shopUuid:t,shopName:e,shopImage:a}),$("#shopsCheckedList").append("<div class='shopChecked relative col m3 l3' id='ss-"+t+"'><div onclick=\"removeShop('"+t+"')\" class='removeShopArray absolute'>X</div><div class='shopCheckedTitle color-white'>"+e+"</div><div class='shopCheckedImage'><img src='"+a+"' alt=''></div></div>")):this.checked||removeShop(t)}))},error:function(t,e,a){console.log("Status: "+e),console.log("Error: "+a)}})):$("#comTable tr").remove()}));